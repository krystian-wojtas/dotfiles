#!/bin/bash

# Stop on first failure
set -e

# Show each command
set -x

# Name of internet interface
IFNAME=eth0

# Disable wifi
killall wpa_supplicant || true

# Set interface up and running
ip link set "$IFNAME" up

# Get ip address
dhclient "$IFNAME"

# Figure out new ip address
address_ip=$(ip addr show "$IFNAME" | perl -nE '/inet ([\d\.]+)/ and say "$1"')

# Update default route
ip route delete default
ip route add default via "$address_ip"
